import{r as P,m as R,j as U,d as M,u as B,e as x,p as N,q,s as z,c as _,a,t as d,b as t,g as O,F as V,f as A,x as W,n as u,h as f,w as v,v as p,y as $,l as j,o as b}from"./vue-vendor-D_FnZyjM.js";import{u as H,c as L,g as G,_ as J}from"./_plugin-vue_export-helper-BkCLdZia.js";const Q=()=>{const E=U(),y=P(!1),l=R({title:"",description:"",content:"",categoryKey:"dit",tag:"",badge:"",date:new Date().toISOString().split("T")[0],platform:"Wechat",cover:"linear-gradient(135deg, #0a0f26 0%, #0c1a4d 35%, #032c5f 65%, #0c1a4d 100%)"}),o=()=>{l.title="",l.description="",l.content="",l.categoryKey="dit",l.tag="",l.badge="",l.date=new Date().toISOString().split("T")[0],l.platform="Wechat",l.cover="linear-gradient(135deg, #0a0f26 0%, #0c1a4d 35%, #032c5f 65%, #0c1a4d 100%)"},g=r=>{l.id=r.id,l.title=r.title,l.description=r.description,l.content=r.content,l.categoryKey=r.categoryKey,l.tag=r.tag,l.badge=r.badge,l.date=r.date,l.platform=r.platform,l.cover=r.cover},h=()=>{const r=[];return l.title?.trim()||r.push({field:"title",message:"title"}),l.description?.trim()||r.push({field:"description",message:"description"}),l.content?.trim()||r.push({field:"content",message:"content"}),l.categoryKey||r.push({field:"category",message:"category"}),l.tag?.trim()||r.push({field:"tag",message:"tag"}),l.date||r.push({field:"date",message:"date"}),l.platform?.trim()||r.push({field:"platform",message:"platform"}),l.cover?.trim()||r.push({field:"cover",message:"cover"}),r},s=async()=>{if(h().length>0)return null;y.value=!0;try{let k;return l.id?k=H(l.id,l):k=L(l),k}finally{y.value=!1}};return{form:l,isSubmitting:y,resetForm:o,loadArticle:g,validateForm:h,handleSubmit:s,handleSubmitAndRedirect:async()=>{const r=await s();r&&E.push({name:"articleDetail",params:{id:r.id}})}}},X={class:"layout edit-layout"},Y={class:"hero"},Z={class:"edit-content"},ee={key:0,class:"validation-errors"},te={class:"error-header"},ae={class:"error-title"},le={class:"error-list"},oe={class:"form-section"},se=["placeholder"],re={class:"form-section"},ie=["placeholder"],ce={class:"form-row"},ne={class:"form-section"},de=["value"],ue={class:"form-section"},me=["placeholder"],fe={class:"form-row"},ve={class:"form-section"},pe={class:"form-section"},ge=["placeholder"],he={class:"form-row"},_e={class:"form-section"},be={class:"form-label"},ye=["placeholder"],ke={class:"form-section"},Se=["placeholder"],we={class:"form-section"},xe={class:"form-label"},Ve={class:"cover-presets"},Ae=["onClick"],Pe={class:"form-section"},Ee=["placeholder"],Ue={class:"form-hint"},De={class:"form-actions"},Ke=["disabled"],Ce=M({__name:"ArticleEditPage",setup(E){const y=N(),l=U(),{t:o}=B(),g=x(()=>!!y.params.id),h=x(()=>{const m=y.params.id;return m?Number(m):null}),{form:s,isSubmitting:S,loadArticle:r,validateForm:k,handleSubmitAndRedirect:D,resetForm:K}=Q(),c=P([]),n=P(!1),C=x(()=>[{key:"dit",label:o("categories.dit")},{key:"luna",label:o("categories.luna")},{key:"note",label:o("categories.note")},{key:"art",label:o("categories.art")},{key:"travel",label:o("categories.travel")}]),F=["linear-gradient(135deg, #0a0f26 0%, #0c1a4d 35%, #032c5f 65%, #0c1a4d 100%)","linear-gradient(135deg, #0d121f 0%, #132642 50%, #243c5a 100%)","linear-gradient(135deg, #101820 0%, #1f1f2f 50%, #2c2c3b 100%)","linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)","linear-gradient(135deg, #2d1b69 0%, #11998e 100%)","linear-gradient(135deg, #667eea 0%, #764ba2 100%)"];q(()=>{if(g.value&&h.value){const m=G(h.value);m?r(m):l.push({name:"articles"})}else K()}),z(()=>[s.title,s.description,s.content,s.categoryKey,s.tag,s.date,s.platform,s.cover],()=>{if(n.value&&c.value.length>0){const m=k();c.value=m,m.length===0&&(n.value=!1)}});const I=()=>{g.value&&h.value?l.push({name:"articleDetail",params:{id:h.value}}):l.push({name:"articles"})},T=async()=>{const m=k();if(m.length>0){c.value=m,n.value=!0,setTimeout(()=>{const i=document.querySelector(".form-error");i&&i.scrollIntoView({behavior:"smooth",block:"center"})},100);return}c.value=[],n.value=!1,await D()};return(m,i)=>(b(),_("main",X,[a("section",Y,[a("h1",null,d(g.value?t(o)("article.editTitle"):t(o)("article.createTitle")),1),a("p",null,d(g.value?t(o)("article.editDesc"):t(o)("article.createDesc")),1)]),a("section",Z,[n.value&&c.value.length>0?(b(),_("div",ee,[a("div",te,[i[9]||(i[9]=a("span",{class:"error-icon"},"⚠️",-1)),a("span",ae,d(t(o)("article.validationError")),1)]),a("ul",le,[(b(!0),_(V,null,A(c.value,(e,w)=>(b(),_("li",{key:w,class:"error-item"},d(t(o)(`article.${e.message}Required`)),1))),128))])])):O("",!0),a("form",{class:"article-form",onSubmit:W(T,["prevent"])},[a("div",oe,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="title")}])},[f(d(t(o)("article.title"))+" ",1),v(a("input",{"onUpdate:modelValue":i[0]||(i[0]=e=>t(s).title=e),type:"text",placeholder:t(o)("article.titlePlaceholder"),class:u({"form-error":n.value&&c.value.some(e=>e.field==="title")})},null,10,se),[[p,t(s).title]])],2)]),a("div",re,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="description")}])},[f(d(t(o)("article.description"))+" ",1),v(a("textarea",{"onUpdate:modelValue":i[1]||(i[1]=e=>t(s).description=e),rows:"3",placeholder:t(o)("article.descriptionPlaceholder"),class:u({"form-error":n.value&&c.value.some(e=>e.field==="description")})},null,10,ie),[[p,t(s).description]])],2)]),a("div",ce,[a("div",ne,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="category")}])},[f(d(t(o)("article.category"))+" ",1),v(a("select",{"onUpdate:modelValue":i[2]||(i[2]=e=>t(s).categoryKey=e),class:u({"form-error":n.value&&c.value.some(e=>e.field==="category")})},[(b(!0),_(V,null,A(C.value,e=>(b(),_("option",{key:e.key,value:e.key},d(e.label),9,de))),128))],2),[[$,t(s).categoryKey]])],2)]),a("div",ue,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="tag")}])},[f(d(t(o)("article.tag"))+" ",1),v(a("input",{"onUpdate:modelValue":i[3]||(i[3]=e=>t(s).tag=e),type:"text",placeholder:t(o)("article.tagPlaceholder"),class:u({"form-error":n.value&&c.value.some(e=>e.field==="tag")})},null,10,me),[[p,t(s).tag]])],2)])]),a("div",fe,[a("div",ve,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="date")}])},[f(d(t(o)("article.date"))+" ",1),v(a("input",{"onUpdate:modelValue":i[4]||(i[4]=e=>t(s).date=e),type:"date",class:u({"form-error":n.value&&c.value.some(e=>e.field==="date")})},null,2),[[p,t(s).date]])],2)]),a("div",pe,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="platform")}])},[f(d(t(o)("article.platform"))+" ",1),v(a("input",{"onUpdate:modelValue":i[5]||(i[5]=e=>t(s).platform=e),type:"text",placeholder:t(o)("article.platformPlaceholder"),class:u({"form-error":n.value&&c.value.some(e=>e.field==="platform")})},null,10,ge),[[p,t(s).platform]])],2)])]),a("div",he,[a("div",_e,[a("label",be,[f(d(t(o)("article.badge"))+" ",1),v(a("input",{"onUpdate:modelValue":i[6]||(i[6]=e=>t(s).badge=e),type:"text",placeholder:t(o)("article.badgePlaceholder")},null,8,ye),[[p,t(s).badge]])])]),a("div",ke,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="cover")}])},[f(d(t(o)("article.cover"))+" ",1),v(a("input",{"onUpdate:modelValue":i[7]||(i[7]=e=>t(s).cover=e),type:"text",placeholder:t(o)("article.coverPlaceholder"),class:u({"form-error":n.value&&c.value.some(e=>e.field==="cover")})},null,10,Se),[[p,t(s).cover]])],2)])]),a("div",we,[a("label",xe,[f(d(t(o)("article.coverPresets"))+" ",1),a("div",Ve,[(b(),_(V,null,A(F,(e,w)=>a("button",{key:w,type:"button",class:"cover-preset",style:j({background:e}),onClick:Fe=>t(s).cover=e},null,12,Ae)),64))])])]),a("div",Pe,[a("label",{class:u(["form-label",{"has-error":n.value&&c.value.some(e=>e.field==="content")}])},[f(d(t(o)("article.content"))+" ",1),v(a("textarea",{"onUpdate:modelValue":i[8]||(i[8]=e=>t(s).content=e),rows:"20",placeholder:t(o)("article.contentPlaceholder"),class:u(["content-textarea",{"form-error":n.value&&c.value.some(e=>e.field==="content")}])},null,10,Ee),[[p,t(s).content]])],2),a("p",Ue,d(t(o)("article.contentHint")),1)]),a("div",De,[a("button",{type:"button",class:"cancel-btn",onClick:I},d(t(o)("article.cancel")),1),a("button",{type:"submit",class:"submit-btn",disabled:t(S)},d(t(S)?t(o)("article.saving"):g.value?t(o)("article.update"):t(o)("article.publish")),9,Ke)])],32)])]))}}),Re=J(Ce,[["__scopeId","data-v-67a90715"]]);export{Re as default};
