import{e as C,r as H,d as x,u as k,c as f,a as r,g as M,t as m,b as p,o as v,J as S,q as P,s as K,l as j,F as z,f as O,m as U,x as Q,h as I,w as D,v as B,p as W,D as A,j as X}from"./vue-vendor-D_FnZyjM.js";import{g as Y,a as L}from"./index-DjoCxPOh.js";import{r as Z,g as F,a as tt,M as et,i as ot}from"./markdown-vendor-BDlm1NQN.js";import{H as q}from"./highlight-vendor-2JJYcUgK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b8 as N,b9 as nt}from"./math-vendor-D-aPKjIh.js";var st=Z();const rt=F(st),w=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var at=tt();const ct=F(at),it=t=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),E=new et({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(t,e){if(e==="flowchart"||e==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+w(t)+"</pre></div>";if(e==="mermaid"||e==="sequenceDiagram"||e==="classDiagram"||e==="stateDiagram"||e==="erDiagram"||e==="journey"||e==="gantt"||e==="pie"||e==="requirement"||e==="gitgraph"||e==="mindmap"||e==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+w(t)+"</pre></div>";if(e&&q.getLanguage(e))try{return'<pre class="hljs"><code class="language-'+w(e)+'">'+q.highlight(t,{language:e}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+w(t)+"</code></pre>"}});E.use(ot);E.use(rt);E.use(ct,{enabled:!0,label:!0,labelAfter:!0});const V=t=>{if(!t||!Array.isArray(t))return"";let e="";for(const o of t)o?.type==="text"&&o.content||o?.type==="code_inline"&&o.content?e+=o.content:o?.children&&(e+=V(o.children));return e};E.use(function(t){const e=t.renderer.rules.heading_open||function(o,h,u,d,i){return i.renderToken(o,h,u)};t.renderer.rules.heading_open=function(o,h,u,d,i){const n=o[h];if(!n)return e(o,h,u,d,i);const c=parseInt(n.tag.slice(1));let a="",s=h+1;for(;s<o.length&&o[s]?.type!=="heading_close";){const b=o[s];if(b?.type==="inline"){b.children?a=V(b.children):a=b.content||"";break}s++}const l=it(a),_=d.headingCount||{},y=_[l]||0;_[l]=y+1;const T=y?`${l}-${y}`:l;return d.toc||(d.toc=[]),d.toc.push({id:T,text:a,level:c}),n.attrSet("id",T),e(o,h,u,d,i)}});const lt=t=>{const e={toc:[],headingCount:{}};return{html:E.render(t,e),toc:e.toc||[]}},dt=t=>C(()=>lt(t.value||"")),ut=(t="article-comments")=>{const e=H({}),o=()=>{try{const i=localStorage.getItem(t);e.value=i?JSON.parse(i):{}}catch{e.value={}}},h=()=>{localStorage.setItem(t,JSON.stringify(e.value))};return{commentsMap:e,loadComments:o,getComments:i=>e.value[i]??[],addComment:(i,n)=>{const c=n.content.trim();if(!c)return;const a=n.author?.trim()||"匿名",s=e.value[i]??[],l={id:Date.now(),author:a,content:c,createdAt:new Date().toISOString()};return e.value={...e.value,[i]:[...s,l]},h(),l}}},mt={class:"hero detail-hero"},ht={class:"header-actions"},pt={key:0,class:"title-area"},ft={key:0,class:"badge"},vt={class:"meta"},_t={key:1,class:"title-area"},gt={class:"meta"},yt=x({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(t,{emit:e}){const o=e,{t:h}=k();return(u,d)=>(v(),f("section",mt,[r("div",ht,[r("button",{class:"back-btn",type:"button",onClick:d[0]||(d[0]=i=>o("goBack"))},"← "+m(p(h)("article.back")),1),t.article?(v(),f("button",{key:0,class:"edit-btn",type:"button",onClick:d[1]||(d[1]=i=>o("edit"))},"✎ "+m(p(h)("article.edit")),1)):M("",!0)]),t.article?(v(),f("div",pt,[t.article.badge?(v(),f("span",ft,m(t.article.badge),1)):M("",!0),r("h1",null,m(t.article.title),1),r("p",vt,[r("span",null,m(t.article.date),1),d[2]||(d[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),d[3]||(d[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)])])):(v(),f("div",_t,[r("h1",null,m(p(h)("article.notFound")),1),r("p",gt,m(p(h)("article.notFoundDesc")),1)]))]))}}),Ct=$(yt,[["__scopeId","data-v-0f3ff6f9"]]),bt=(t,e)=>{const h=e||(a=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[a]||a),u=a=>{const s=a.textContent;a.textContent=h("copied"),a.classList.add("copied"),setTimeout(()=>{a.textContent=s,a.classList.remove("copied")},2e3)},d=a=>{const s=a.textContent;a.textContent=h("copyFailed"),a.classList.add("error"),setTimeout(()=>{a.textContent=s,a.classList.remove("error")},2e3)},i=async(a,s)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),d(s);return}try{await navigator.clipboard.writeText(a),u(s)}catch(l){console.error("复制失败:",l),d(s)}},n=a=>{const s=document.createElement("button");return s.className="copy-code-btn",s.textContent=h("copy"),s.type="button",s.setAttribute("aria-label",h("copyCode")),s.addEventListener("click",()=>{i(a,s)}),s};return{addCopyButtons:()=>{S(()=>{if(!t.value)return;t.value.querySelectorAll("pre.hljs").forEach(s=>{if(s.querySelector(".copy-code-btn"))return;const l=s.querySelector("code");if(!l)return;const _=l.textContent||l.innerText||"",y=n(_);s.appendChild(y)})})}}},wt=t=>{let e=!1;const o=()=>{e||(N.initialize({startOnLoad:!1,theme:"default",securityLevel:"loose"}),e=!0)},h=i=>{const n=i.id||"mermaid-"+Math.random().toString(36).substr(2,9),c=i.textContent||"";if(!c.trim())return;i.classList.add("mermaid-rendered");const a=n+"-svg";N.render(a,c).then(s=>{const l=i.parentElement;l&&l.classList.contains("mermaid-container")?l.innerHTML=s.svg:i.innerHTML=s.svg}).catch(s=>{console.error("Mermaid 渲染失败:",s),u(i,c)})},u=(i,n)=>{const c=i.parentElement;c&&c.classList.contains("mermaid-container")&&(c.innerHTML='<pre class="mermaid-error">'+w(n)+"</pre>")};return{initMermaid:()=>{S(()=>{if(!t.value)return;o(),t.value.querySelectorAll("pre.mermaid:not(.mermaid-rendered)").forEach(n=>{h(n)})})}}};var xt=nt();const kt=F(xt),$t=t=>{const e=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},o=()=>{const{textColor:n,lineColor:c,fillColor:a,isDark:s}=e();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":c,"element-color":n,fill:a,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:s?"#444444":"#CCCCCC","font-size":12},current:{fill:s?"#4a4a00":"yellow","font-color":s?"#ff6b6b":"red","font-weight":"bold"},future:{fill:s?"#666600":"#FFFF99"},request:{fill:s?"#003366":"blue"},invalid:{fill:s?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},h=n=>{const c=document.createElement("div");return c.className="flowchart-svg-container",c.id=n+"-svg",c},u=n=>{const c=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),a=n.textContent||"";if(a.trim()){n.classList.add("flowchart-rendered");try{const s=kt.parse(a),l=h(c),_=n.parentElement;if(_&&_.classList.contains("flowchart-container")){_.innerHTML="",_.appendChild(l);const y=o();s.drawSVG(c+"-svg",y)}}catch(s){console.error("Flowchart 渲染失败:",s),d(n,a)}}},d=(n,c)=>{const a=n.parentElement;a&&a.classList.contains("flowchart-container")&&(a.innerHTML='<pre class="flowchart-error">'+w(c)+"</pre>")};return{initFlowchart:()=>{S(()=>{if(!t.value)return;t.value.querySelectorAll("pre.flowchart:not(.flowchart-rendered)").forEach(c=>{u(c)})})}}},Et={class:"article-card detail-card"},Tt={key:0,class:"badge"},At={class:"card-body"},Lt={class:"tag-row"},Mt={class:"tag"},St={class:"title"},Ft={class:"description"},It={class:"meta"},Dt={class:"nav-row"},Bt=["disabled"],qt=["disabled"],Nt=["innerHTML"],Ht=x({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(t,{emit:e}){const{t:o}=k(),h=t,u=e,d=H(),{addCopyButtons:i}=bt(d,s=>({copy:o("code.copy"),copied:o("code.copied"),copyFailed:o("code.copyFailed"),copyCode:o("code.copyCode")})[s]||s),{initMermaid:n}=wt(d),{initFlowchart:c}=$t(d),a=()=>{i(),n(),c()};return P(()=>{a()}),K(()=>h.htmlContent,()=>{a()}),(s,l)=>(v(),f("article",Et,[r("div",{class:"card-cover",style:j({background:t.article.cover})},[t.article.badge?(v(),f("span",Tt,m(t.article.badge),1)):M("",!0)],4),r("div",At,[r("div",Lt,[r("span",Mt,m(t.article.tag),1)]),r("h2",St,m(t.article.title),1),r("p",Ft,m(t.article.description),1),r("div",It,[r("span",null,m(t.article.date),1),l[2]||(l[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),l[3]||(l[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)]),r("div",Dt,[r("button",{class:"ghost-btn",type:"button",disabled:!t.prevArticle,onClick:l[0]||(l[0]=_=>u("goPrev"))}," ← "+m(p(o)("article.prevArticle")),9,Bt),r("button",{class:"ghost-btn",type:"button",disabled:!t.nextArticle,onClick:l[1]||(l[1]=_=>u("goNext"))},m(p(o)("article.nextArticle"))+" → ",9,qt)]),r("div",{ref_key:"contentBlockRef",ref:d,class:"content-block",innerHTML:t.htmlContent},null,8,Nt)])]))}}),Pt=$(Ht,[["__scopeId","data-v-b02ed7b5"]]),jt={key:0,class:"toc"},zt={class:"toc-title"},Ot=["href"],Vt=x({__name:"ArticleTOC",props:{toc:{}},setup(t){const{t:e}=k();return(o,h)=>t.toc.length?(v(),f("aside",jt,[r("div",zt,m(p(e)("toc.title")),1),r("nav",null,[(v(!0),f(z,null,O(t.toc,u=>(v(),f("a",{key:u.id,class:"toc-item",style:j({paddingLeft:`${(u.level-1)*12}px`}),href:`#${u.id}`},m(u.text),13,Ot))),128))])])):M("",!0)}}),Jt=$(Vt,[["__scopeId","data-v-b533dff0"]]),Rt={class:"comments"},Gt={class:"comments__header"},Kt={class:"comments__count"},Ut={key:0,class:"comments__list"},Qt={class:"comment__header"},Wt={class:"comment__author"},Xt={class:"comment__time"},Yt={class:"comment__content"},Zt={key:1,class:"comments__empty"},te={class:"form-row"},ee=["placeholder"],oe={class:"form-row"},ne=["placeholder"],se={class:"submit-btn",type:"submit"},re=x({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(t,{emit:e}){const{t:o}=k(),h=e,u=U({author:"",content:""}),d=()=>{const i=u.content.trim();i&&(h("submit",{author:u.author,content:i}),u.author="",u.content="")};return(i,n)=>(v(),f("section",Rt,[r("header",Gt,[r("h3",null,m(p(o)("comments.title")),1),r("span",Kt,m(p(o)("comments.count",{count:t.comments.length})),1)]),t.comments.length?(v(),f("ul",Ut,[(v(!0),f(z,null,O(t.comments,c=>(v(),f("li",{key:c.id,class:"comment"},[r("div",Qt,[r("span",Wt,m(c.author),1),r("span",Xt,m(new Date(c.createdAt).toLocaleString()),1)]),r("p",Yt,m(c.content),1)]))),128))])):(v(),f("p",Zt,m(p(o)("comments.empty")),1)),r("form",{class:"comment-form",onSubmit:Q(d,["prevent"])},[r("div",te,[r("label",null,[I(m(p(o)("comments.authorLabel"))+" ",1),D(r("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>u.author=c),placeholder:p(o)("comments.authorPlaceholder")},null,8,ee),[[B,u.author]])])]),r("div",oe,[r("label",null,[I(m(p(o)("comments.contentLabel"))+" ",1),D(r("textarea",{"onUpdate:modelValue":n[1]||(n[1]=c=>u.content=c),rows:"4",required:"",placeholder:p(o)("comments.contentPlaceholder")},null,8,ne),[[B,u.content]])])]),r("button",se,m(p(o)("comments.submit")),1)],32)]))}}),ae=$(re,[["__scopeId","data-v-2472bcd1"]]),ce={class:"layout detail-layout"},ie={class:"article-area"},le={key:0,class:"detail-grid"},de={class:"content-wrapper"},ue={key:1,class:"article-card detail-card empty-state"},me={class:"card-body"},he={class:"title"},pe={class:"description"},fe=x({__name:"ArticleDetailPage",setup(t){const e=W(),o=X(),{t:h}=k(),{loadComments:u,getComments:d,addComment:i}=ut(),n=C(()=>{const g=Number(e.params.id);return Number.isFinite(g)?Y(g)??null:null}),c=C(()=>n.value?.content??""),a=dt(c),s=C(()=>n.value?L.findIndex(g=>g.id===n.value?.id):-1),l=C(()=>s.value>0?L[s.value-1]:null),_=C(()=>s.value>=0&&s.value<L.length-1?L[s.value+1]:null),y=C(()=>{const g=n.value?.id;return g?d(g):[]}),T=()=>{o.back()},b=()=>{l.value&&o.push({name:"articleDetail",params:{id:l.value.id}})},J=()=>{_.value&&o.push({name:"articleDetail",params:{id:_.value.id}})},R=()=>{n.value&&o.push({name:"articleEdit",params:{id:n.value.id}})},G=g=>{n.value&&i(n.value.id,g)};return P(()=>{u()}),(g,ve)=>(v(),f("main",ce,[A(Ct,{article:n.value,onGoBack:T,onEdit:R},null,8,["article"]),r("section",ie,[n.value?(v(),f("div",le,[r("div",de,[A(Pt,{article:n.value,"html-content":p(a).html,"prev-article":l.value??null,"next-article":_.value??null,onGoPrev:b,onGoNext:J},null,8,["article","html-content","prev-article","next-article"]),A(ae,{comments:y.value,"article-id":n.value.id,onSubmit:G},null,8,["comments","article-id"])]),A(Jt,{toc:p(a).toc},null,8,["toc"])])):(v(),f("article",ue,[r("div",me,[r("h2",he,m(p(h)("article.notFound")),1),r("p",pe,m(p(h)("article.notFoundDesc")),1)])]))])]))}}),xe=$(fe,[["__scopeId","data-v-0f6adb11"]]);export{xe as default};
