import{c as C,r as N,d as x,u as k,a as f,b as r,i as S,t as m,e as p,h as v,N as M,o as P,s as K,n as z,F as O,g as V,p as U,x as Q,k as I,w as D,v as B,q as W,D as A,l as X}from"./vue-vendor-B1el7s55.js";import{g as Y,a as L}from"./index-eZel76Zb.js";import{r as Z,g as F,a as tt,M as et,i as ot}from"./markdown-vendor-BDlm1NQN.js";import{H as q}from"./highlight-vendor-2JJYcUgK.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b8 as H,b9 as nt}from"./math-vendor-C4rbpj_m.js";import{g as st}from"./coverStyle-BhxAb7xK.js";var rt=Z();const at=F(rt),w=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var ct=tt();const it=F(ct),lt=t=>t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-"),E=new et({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(t,e){if(e==="flowchart"||e==="flow")return'<div class="flowchart-container"><pre class="flowchart" id="'+("flowchart-"+Math.random().toString(36).substr(2,9))+'">'+w(t)+"</pre></div>";if(e==="mermaid"||e==="sequenceDiagram"||e==="classDiagram"||e==="stateDiagram"||e==="erDiagram"||e==="journey"||e==="gantt"||e==="pie"||e==="requirement"||e==="gitgraph"||e==="mindmap"||e==="timeline")return'<div class="mermaid-container"><pre class="mermaid" id="'+("mermaid-"+Math.random().toString(36).substr(2,9))+'">'+w(t)+"</pre></div>";if(e&&q.getLanguage(e))try{return'<pre class="hljs"><code class="language-'+w(e)+'">'+q.highlight(t,{language:e}).value+"</code></pre>"}catch{}return'<pre class="hljs"><code>'+w(t)+"</code></pre>"}});E.use(ot);E.use(at);E.use(it,{enabled:!0,label:!0,labelAfter:!0});const j=t=>{if(!t||!Array.isArray(t))return"";let e="";for(const o of t)o?.type==="text"&&o.content||o?.type==="code_inline"&&o.content?e+=o.content:o?.children&&(e+=j(o.children));return e};E.use(function(t){const e=t.renderer.rules.heading_open||function(o,h,u,d,i){return i.renderToken(o,h,u)};t.renderer.rules.heading_open=function(o,h,u,d,i){const n=o[h];if(!n)return e(o,h,u,d,i);const c=parseInt(n.tag.slice(1));let a="",s=h+1;for(;s<o.length&&o[s]?.type!=="heading_close";){const b=o[s];if(b?.type==="inline"){b.children?a=j(b.children):a=b.content||"";break}s++}const l=lt(a),_=d.headingCount||{},y=_[l]||0;_[l]=y+1;const T=y?`${l}-${y}`:l;return d.toc||(d.toc=[]),d.toc.push({id:T,text:a,level:c}),n.attrSet("id",T),e(o,h,u,d,i)}});const dt=t=>{const e={toc:[],headingCount:{}};return{html:E.render(t,e),toc:e.toc||[]}},ut=t=>C(()=>dt(t.value||"")),mt=(t="article-comments")=>{const e=N({}),o=()=>{try{const i=localStorage.getItem(t);e.value=i?JSON.parse(i):{}}catch{e.value={}}},h=()=>{localStorage.setItem(t,JSON.stringify(e.value))};return{commentsMap:e,loadComments:o,getComments:i=>e.value[i]??[],addComment:(i,n)=>{const c=n.content.trim();if(!c)return;const a=n.author?.trim()||"匿名",s=e.value[i]??[],l={id:Date.now(),author:a,content:c,createdAt:new Date().toISOString()};return e.value={...e.value,[i]:[...s,l]},h(),l}}},ht={class:"hero detail-hero"},pt={class:"header-actions"},ft={key:0,class:"title-area"},vt={key:0,class:"badge"},_t={class:"meta"},gt={key:1,class:"title-area"},yt={class:"meta"},Ct=x({__name:"ArticleHeader",props:{article:{}},emits:["goBack","edit"],setup(t,{emit:e}){const o=e,{t:h}=k();return(u,d)=>(v(),f("section",ht,[r("div",pt,[r("button",{class:"back-btn",type:"button",onClick:d[0]||(d[0]=i=>o("goBack"))},"← "+m(p(h)("article.back")),1),t.article?(v(),f("button",{key:0,class:"edit-btn",type:"button",onClick:d[1]||(d[1]=i=>o("edit"))},"✎ "+m(p(h)("article.edit")),1)):S("",!0)]),t.article?(v(),f("div",ft,[t.article.badge?(v(),f("span",vt,m(t.article.badge),1)):S("",!0),r("h1",null,m(t.article.title),1),r("p",_t,[r("span",null,m(t.article.date),1),d[2]||(d[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),d[3]||(d[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)])])):(v(),f("div",gt,[r("h1",null,m(p(h)("article.notFound")),1),r("p",yt,m(p(h)("article.notFoundDesc")),1)]))]))}}),bt=$(Ct,[["__scopeId","data-v-0f3ff6f9"]]),wt=(t,e)=>{const h=e||(a=>({copy:"复制",copied:"已复制!",copyFailed:"复制失败",copyCode:"复制代码"})[a]||a),u=a=>{const s=a.textContent;a.textContent=h("copied"),a.classList.add("copied"),setTimeout(()=>{a.textContent=s,a.classList.remove("copied")},2e3)},d=a=>{const s=a.textContent;a.textContent=h("copyFailed"),a.classList.add("error"),setTimeout(()=>{a.textContent=s,a.classList.remove("error")},2e3)},i=async(a,s)=>{if(!navigator.clipboard||!navigator.clipboard.writeText){console.error("Clipboard API 不可用"),d(s);return}try{await navigator.clipboard.writeText(a),u(s)}catch(l){console.error("复制失败:",l),d(s)}},n=a=>{const s=document.createElement("button");return s.className="copy-code-btn",s.textContent=h("copy"),s.type="button",s.setAttribute("aria-label",h("copyCode")),s.addEventListener("click",()=>{i(a,s)}),s};return{addCopyButtons:()=>{M(()=>{if(!t.value)return;t.value.querySelectorAll("pre.hljs").forEach(s=>{if(s.querySelector(".copy-code-btn"))return;const l=s.querySelector("code");if(!l)return;const _=l.textContent||l.innerText||"",y=n(_);s.appendChild(y)})})}}},xt=t=>{let e=!1;const o=()=>{e||(H.initialize({startOnLoad:!1,theme:"default",securityLevel:"loose"}),e=!0)},h=i=>{const n=i.id||"mermaid-"+Math.random().toString(36).substr(2,9),c=i.textContent||"";if(!c.trim())return;i.classList.add("mermaid-rendered");const a=n+"-svg";H.render(a,c).then(s=>{const l=i.parentElement;l&&l.classList.contains("mermaid-container")?l.innerHTML=s.svg:i.innerHTML=s.svg}).catch(s=>{console.error("Mermaid 渲染失败:",s),u(i,c)})},u=(i,n)=>{const c=i.parentElement;c&&c.classList.contains("mermaid-container")&&(c.innerHTML='<pre class="mermaid-error">'+w(n)+"</pre>")};return{initMermaid:()=>{M(()=>{if(!t.value)return;o(),t.value.querySelectorAll("pre.mermaid:not(.mermaid-rendered)").forEach(n=>{h(n)})})}}};var kt=nt();const $t=F(kt),Et=t=>{const e=()=>{const n=document.documentElement.classList.contains("dark");return{textColor:n?"#e0e0e0":"#000000",lineColor:n?"#e0e0e0":"#000000",fillColor:n?"#2a2a2a":"#ffffff",isDark:n}},o=()=>{const{textColor:n,lineColor:c,fillColor:a,isDark:s}=e();return{"line-width":2,"line-length":50,"text-margin":10,"font-size":14,"font-color":n,"line-color":c,"element-color":n,fill:a,"yes-text":"yes","no-text":"no","arrow-end":"block",scale:1,flowstate:{past:{fill:s?"#444444":"#CCCCCC","font-size":12},current:{fill:s?"#4a4a00":"yellow","font-color":s?"#ff6b6b":"red","font-weight":"bold"},future:{fill:s?"#666600":"#FFFF99"},request:{fill:s?"#003366":"blue"},invalid:{fill:s?"#222222":"#444444"},approved:{fill:"#58C4A3","font-size":12,"yes-text":"APPROVED","no-text":"n/a"},rejected:{fill:"#C45879","font-size":12,"yes-text":"n/a","no-text":"REJECTED"}}}},h=n=>{const c=document.createElement("div");return c.className="flowchart-svg-container",c.id=n+"-svg",c},u=n=>{const c=n.id||"flowchart-"+Math.random().toString(36).substr(2,9),a=n.textContent||"";if(a.trim()){n.classList.add("flowchart-rendered");try{const s=$t.parse(a),l=h(c),_=n.parentElement;if(_&&_.classList.contains("flowchart-container")){_.innerHTML="",_.appendChild(l);const y=o();s.drawSVG(c+"-svg",y)}}catch(s){console.error("Flowchart 渲染失败:",s),d(n,a)}}},d=(n,c)=>{const a=n.parentElement;a&&a.classList.contains("flowchart-container")&&(a.innerHTML='<pre class="flowchart-error">'+w(c)+"</pre>")};return{initFlowchart:()=>{M(()=>{if(!t.value)return;t.value.querySelectorAll("pre.flowchart:not(.flowchart-rendered)").forEach(c=>{u(c)})})}}},Tt={class:"article-card detail-card"},At={key:0,class:"badge"},Lt={class:"card-body"},St={class:"tag-row"},Mt={class:"tag"},Ft={class:"title"},It={class:"description"},Dt={class:"meta"},Bt={class:"nav-row"},qt=["disabled"],Ht=["disabled"],Nt=["innerHTML"],Pt=x({__name:"ArticleContent",props:{article:{},htmlContent:{},prevArticle:{},nextArticle:{}},emits:["goPrev","goNext"],setup(t,{emit:e}){const{t:o}=k(),h=t,u=e,d=N(),{addCopyButtons:i}=wt(d,s=>({copy:o("code.copy"),copied:o("code.copied"),copyFailed:o("code.copyFailed"),copyCode:o("code.copyCode")})[s]||s),{initMermaid:n}=xt(d),{initFlowchart:c}=Et(d),a=()=>{i(),n(),c()};return P(()=>{a()}),K(()=>h.htmlContent,()=>{a()}),(s,l)=>(v(),f("article",Tt,[r("div",{class:"card-cover",style:z(p(st)(t.article.cover))},[t.article.badge?(v(),f("span",At,m(t.article.badge),1)):S("",!0)],4),r("div",Lt,[r("div",St,[r("span",Mt,m(t.article.tag),1)]),r("h2",Ft,m(t.article.title),1),r("p",It,m(t.article.description),1),r("div",Dt,[r("span",null,m(t.article.date),1),l[2]||(l[2]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.platform),1),l[3]||(l[3]=r("span",{class:"dot"},"·",-1)),r("span",null,m(t.article.tag),1)]),r("div",Bt,[r("button",{class:"ghost-btn",type:"button",disabled:!t.prevArticle,onClick:l[0]||(l[0]=_=>u("goPrev"))}," ← "+m(p(o)("article.prevArticle")),9,qt),r("button",{class:"ghost-btn",type:"button",disabled:!t.nextArticle,onClick:l[1]||(l[1]=_=>u("goNext"))},m(p(o)("article.nextArticle"))+" → ",9,Ht)]),r("div",{ref_key:"contentBlockRef",ref:d,class:"content-block",innerHTML:t.htmlContent},null,8,Nt)])]))}}),zt=$(Pt,[["__scopeId","data-v-fd530fbc"]]),Ot={key:0,class:"toc"},Vt={class:"toc-title"},jt=["href"],Rt=x({__name:"ArticleTOC",props:{toc:{}},setup(t){const{t:e}=k();return(o,h)=>t.toc.length?(v(),f("aside",Ot,[r("div",Vt,m(p(e)("toc.title")),1),r("nav",null,[(v(!0),f(O,null,V(t.toc,u=>(v(),f("a",{key:u.id,class:"toc-item",style:z({paddingLeft:`${(u.level-1)*12}px`}),href:`#${u.id}`},m(u.text),13,jt))),128))])])):S("",!0)}}),Gt=$(Rt,[["__scopeId","data-v-b533dff0"]]),Jt={class:"comments"},Kt={class:"comments__header"},Ut={class:"comments__count"},Qt={key:0,class:"comments__list"},Wt={class:"comment__header"},Xt={class:"comment__author"},Yt={class:"comment__time"},Zt={class:"comment__content"},te={key:1,class:"comments__empty"},ee={class:"form-row"},oe=["placeholder"],ne={class:"form-row"},se=["placeholder"],re={class:"submit-btn",type:"submit"},ae=x({__name:"CommentSection",props:{comments:{},articleId:{}},emits:["submit"],setup(t,{emit:e}){const{t:o}=k(),h=e,u=U({author:"",content:""}),d=()=>{const i=u.content.trim();i&&(h("submit",{author:u.author,content:i}),u.author="",u.content="")};return(i,n)=>(v(),f("section",Jt,[r("header",Kt,[r("h3",null,m(p(o)("comments.title")),1),r("span",Ut,m(p(o)("comments.count",{count:t.comments.length})),1)]),t.comments.length?(v(),f("ul",Qt,[(v(!0),f(O,null,V(t.comments,c=>(v(),f("li",{key:c.id,class:"comment"},[r("div",Wt,[r("span",Xt,m(c.author),1),r("span",Yt,m(new Date(c.createdAt).toLocaleString()),1)]),r("p",Zt,m(c.content),1)]))),128))])):(v(),f("p",te,m(p(o)("comments.empty")),1)),r("form",{class:"comment-form",onSubmit:Q(d,["prevent"])},[r("div",ee,[r("label",null,[I(m(p(o)("comments.authorLabel"))+" ",1),D(r("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>u.author=c),placeholder:p(o)("comments.authorPlaceholder")},null,8,oe),[[B,u.author]])])]),r("div",ne,[r("label",null,[I(m(p(o)("comments.contentLabel"))+" ",1),D(r("textarea",{"onUpdate:modelValue":n[1]||(n[1]=c=>u.content=c),rows:"4",required:"",placeholder:p(o)("comments.contentPlaceholder")},null,8,se),[[B,u.content]])])]),r("button",re,m(p(o)("comments.submit")),1)],32)]))}}),ce=$(ae,[["__scopeId","data-v-a9391980"]]),ie={class:"layout detail-layout"},le={class:"article-area"},de={key:0,class:"detail-grid"},ue={class:"content-wrapper"},me={key:1,class:"article-card detail-card empty-state"},he={class:"card-body"},pe={class:"title"},fe={class:"description"},ve=x({__name:"ArticleDetailPage",setup(t){const e=W(),o=X(),{t:h}=k(),{loadComments:u,getComments:d,addComment:i}=mt(),n=C(()=>{const g=e.params.id;return g?Y(g)??null:null}),c=C(()=>n.value?.content??""),a=ut(c),s=C(()=>n.value?L.findIndex(g=>g.id===n.value?.id):-1),l=C(()=>s.value>0?L[s.value-1]:null),_=C(()=>s.value>=0&&s.value<L.length-1?L[s.value+1]:null),y=C(()=>{const g=n.value?.id;return g?d(g):[]}),T=()=>{o.back()},b=()=>{l.value&&o.push({name:"articleDetail",params:{id:l.value.id}})},R=()=>{_.value&&o.push({name:"articleDetail",params:{id:_.value.id}})},G=()=>{n.value&&o.push({name:"articleEdit",params:{id:n.value.id}})},J=g=>{n.value&&i(n.value.id,g)};return P(()=>{u()}),(g,_e)=>(v(),f("main",ie,[A(bt,{article:n.value,onGoBack:T,onEdit:G},null,8,["article"]),r("section",le,[n.value?(v(),f("div",de,[r("div",ue,[A(zt,{article:n.value,"html-content":p(a).html,"prev-article":l.value??null,"next-article":_.value??null,onGoPrev:b,onGoNext:R},null,8,["article","html-content","prev-article","next-article"]),A(ce,{comments:y.value,"article-id":n.value.id,onSubmit:J},null,8,["comments","article-id"])]),A(Gt,{toc:p(a).toc},null,8,["toc"])])):(v(),f("article",me,[r("div",he,[r("h2",pe,m(p(h)("article.notFound")),1),r("p",fe,m(p(h)("article.notFoundDesc")),1)])]))])]))}}),$e=$(ve,[["__scopeId","data-v-266627e9"]]);export{$e as default};
